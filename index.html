<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Playlist Bridge（β）</title>
  <meta name="description" content="プレイリストURLを貼るだけ。相手は自分の音楽アプリにインポートできる。" />
  <style>
    :root{
      --bg1:#061326; --bg2:#04101f; --card:rgba(255,255,255,.06);
      --txt:rgba(255,255,255,.92); --mut:rgba(255,255,255,.70);
      --br:rgba(255,255,255,.14); --glow:rgba(110,231,255,.22);
      --ok:#6ee7ff;
    }
    *{box-sizing:border-box}
    body{
      margin:0; color:var(--txt);
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", "Hiragino Sans", "Noto Sans JP", "Meiryo", Arial, sans-serif;
      background: radial-gradient(1200px 800px at 20% 10%, rgba(110,231,255,.12), transparent 60%),
                  radial-gradient(900px 700px at 80% 30%, rgba(167,139,250,.10), transparent 55%),
                  linear-gradient(180deg, var(--bg1), var(--bg2));
      min-height:100vh;
      overflow-x:hidden;
    }
    /* subtle animated background */
    .bg-bubbles{
      position:fixed; inset:0; pointer-events:none; opacity:.55;
      background:
        radial-gradient(10px 10px at 10% 20%, rgba(110,231,255,.18), transparent 60%),
        radial-gradient(14px 14px at 80% 35%, rgba(110,231,255,.14), transparent 62%),
        radial-gradient(8px 8px at 55% 70%, rgba(167,139,250,.14), transparent 60%),
        radial-gradient(12px 12px at 25% 80%, rgba(110,231,255,.12), transparent 62%);
      filter: blur(.2px);
      animation: drift 12s ease-in-out infinite alternate;
    }
    @keyframes drift{ from{transform:translateY(0)} to{transform:translateY(-18px)} }

    .wrap{max-width:980px; margin:0 auto; padding:28px 18px 60px}
    header{display:flex; gap:14px; align-items:center; justify-content:space-between; flex-wrap:wrap}
    .brand{
      display:flex; align-items:center; gap:12px;
    }
    .logo{
      width:44px; height:44px; border-radius:16px;
      background: radial-gradient(circle at 30% 30%, rgba(110,231,255,.9), rgba(110,231,255,.25) 40%, rgba(167,139,250,.18) 75%, rgba(255,255,255,.06));
      box-shadow: 0 0 0 1px var(--br), 0 0 40px rgba(110,231,255,.18);
      position:relative;
    }
    .logo:after{
      content:""; position:absolute; inset:10px 12px auto auto;
      width:10px; height:10px; border-radius:50%;
      background:rgba(255,255,255,.6);
      filter: blur(.2px);
      opacity:.7;
    }
    h1{font-size:20px; margin:0}
    .tag{color:var(--mut); font-size:13px; margin-top:2px}
    .pill{
      padding:8px 10px; border-radius:999px; border:1px solid var(--br);
      background:rgba(255,255,255,.04); color:var(--mut); font-size:12px;
    }

    main{margin-top:18px; display:grid; grid-template-columns: 1.1fr .9fr; gap:14px}
    @media (max-width:860px){ main{grid-template-columns:1fr} }

    .card{
      border:1px solid var(--br);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border-radius:22px;
      box-shadow: 0 10px 50px rgba(0,0,0,.35);
      padding:16px;
      position:relative;
      overflow:hidden;
    }
    .card:before{
      content:""; position:absolute; inset:-1px;
      background: radial-gradient(600px 200px at 10% 0%, rgba(110,231,255,.18), transparent 60%);
      pointer-events:none;
    }

    .lead{font-size:14px; color:var(--mut); line-height:1.6; margin:0 0 12px}
    label{display:block; font-size:12px; color:var(--mut); margin:10px 0 6px}
    input[type="url"]{
      width:100%;
      padding:12px 12px;
      border-radius:14px;
      border:1px solid var(--br);
      outline:none;
      background:rgba(0,0,0,.22);
      color:var(--txt);
      font-size:14px;
    }
    input[type="url"]::placeholder{color:rgba(255,255,255,.38)}
    .row{display:flex; gap:10px; flex-wrap:wrap; align-items:center; margin-top:10px}
    button, a.btn{
      appearance:none; border:1px solid var(--br);
      background: rgba(255,255,255,.06);
      color:var(--txt);
      padding:10px 12px;
      border-radius:14px;
      font-size:14px;
      cursor:pointer;
      text-decoration:none;
      display:inline-flex;
      align-items:center;
      gap:8px;
      transition: transform .06s ease, background .2s ease, border-color .2s ease;
      user-select:none;
    }
    button:hover, a.btn:hover{background: rgba(255,255,255,.09); border-color: rgba(255,255,255,.22)}
    button:active, a.btn:active{transform: translateY(1px)}
    .primary{
      border-color: rgba(110,231,255,.45);
      background: linear-gradient(180deg, rgba(110,231,255,.16), rgba(255,255,255,.06));
      box-shadow: 0 0 0 1px rgba(110,231,255,.12), 0 0 30px rgba(110,231,255,.12);
    }
    .danger{opacity:.9}
    .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Noto Sans Mono", "Courier New", monospace; font-size:12px}
    .hint{font-size:12px; color:var(--mut); margin-top:10px; line-height:1.6}
    .status{
      margin-top:12px;
      padding:10px 12px;
      border-radius:16px;
      border:1px dashed rgba(255,255,255,.18);
      background: rgba(0,0,0,.18);
      color: var(--mut);
      font-size:13px;
      line-height:1.6;
    }
    .status strong{color:var(--txt)}
    .ok{color:var(--ok)}
    .list{
      margin:10px 0 0;
      padding:0 0 0 18px;
      color:var(--mut);
      font-size:13px;
      line-height:1.7;
    }
    footer{margin-top:14px; color:rgba(255,255,255,.45); font-size:12px}
    .smalllink{color:rgba(110,231,255,.85)}
  </style>
</head>

<body>
  <div class="bg-bubbles"></div>

  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>Playlist Bridge <span class="pill">β</span></h1>
          <div class="tag">プレイリストURL → 相手のアプリにインポート（②）＋ そのまま開く（①）</div>
        </div>
      </div>
      <div class="pill">GitHub Pages / 1ページ / 無料運用</div>
    </header>

    <main>
      <section class="card">
        <p class="lead">
          プレイリストのURLを貼ってね。<br/>
          メインは <strong>相手が自分のアプリにインポートできる共有</strong>（TuneMyMusic導線）。保険で各アプリの「そのまま開く」も出す。
        </p>

        <label for="plUrl">プレイリストURL（Apple Music / Spotify / YouTube Music）</label>
        <input id="plUrl" type="url" placeholder="例: https://open.spotify.com/playlist/..." autocomplete="off" />

        <div class="row">
          <button class="primary" id="btnBuild">共有リンクを作る</button>
          <button class="danger" id="btnClear">クリア</button>
          <button id="btnDemo">デモ入力</button>
        </div>

        <div id="status" class="status">
          状態：まだURLが入ってないよ。まず貼って〜
        </div>

        <div class="row" id="actions" style="display:none; margin-top:12px;">
          <a class="btn primary" id="btnTMM" href="#" target="_blank" rel="noopener">② TuneMyMusicでインポート</a>
          <a class="btn" id="btnOpen" href="#" target="_blank" rel="noopener">① 元URLを開く</a>
          <a class="btn" id="btnApple" href="#" target="_blank" rel="noopener">Apple Musicで開く</a>
          <a class="btn" id="btnSpotify" href="#" target="_blank" rel="noopener">Spotifyで開く</a>
          <a class="btn" id="btnYTM" href="#" target="_blank" rel="noopener">YouTube Musicで開く</a>
        </div>

        <div class="hint">
          <strong class="ok">②の使い方</strong>：TuneMyMusicが「共有用のカスタムURLを生成して、友達が自分の音楽プラットフォームにインポートできる」方式を提供してる :contentReference[oaicite:1]{index=1}。<br/>
          ※このβ版は “自動生成” じゃなくて、TuneMyMusicへ<strong>最短導線</strong>で渡す実装（確実に動くやつ）。
        </div>
      </section>

      <aside class="card">
        <h2 style="margin:0 0 8px; font-size:16px;">相手側の流れ（②の体験）</h2>
        <ol class="list">
          <li>あなたがこのページでURLを貼る</li>
          <li><strong>「② TuneMyMusicでインポート」</strong>を押す</li>
          <li>TuneMyMusicで「ソース（元サービス）」を選ぶ → URLを貼る</li>
          <li>相手が「転送先サービス（自分のアプリ）」でログインして許可</li>
          <li>相手のアプリに新しいプレイリストが作られる</li>
        </ol>

        <div class="status" style="margin-top:12px;">
          <strong>注意（でも安心）</strong><br/>
          このサイトはログイン情報を扱わない。貼ったURLを元に、外部サービスに誘導するだけ。<br/>
          “安全で壊れにくい”を最優先にしてる。
        </div>

        <p class="hint">
          TuneMyMusicの共有の考え方（「カスタムURLを生成」「友達が自分の音楽プラットフォームにインポート可能」） :contentReference[oaicite:2]{index=2}
        </p>

        <footer>
          つくり：深海っぽく静かにキラッ…（でも文章は真面目）<br/>
          β版：改善ポイントはどんどん足せる
        </footer>
      </aside>
    </main>
  </div>

<script>
(function(){
  const elUrl = document.getElementById('plUrl');
  const status = document.getElementById('status');
  const actions = document.getElementById('actions');

  const btnBuild = document.getElementById('btnBuild');
  const btnClear = document.getElementById('btnClear');
  const btnDemo  = document.getElementById('btnDemo');

  const btnTMM   = document.getElementById('btnTMM');
  const btnOpen  = document.getElementById('btnOpen');
  const btnApple = document.getElementById('btnApple');
  const btnSpotify = document.getElementById('btnSpotify');
  const btnYTM   = document.getElementById('btnYTM');

  function safeURL(u){
    try{
      const url = new URL(u);
      if(!/^https?:$/.test(url.protocol)) return null;
      return url.toString();
    }catch(e){
      return null;
    }
  }

  function detectPlatform(u){
    // rough detection
    const url = new URL(u);
    const host = url.hostname.toLowerCase();

    // Spotify: open.spotify.com/playlist/{id} など
    if(host.includes('spotify.com')) return 'spotify';

    // Apple Music: music.apple.com/xx/playlist/.../pl.{id} など
    if(host.includes('music.apple.com')) return 'apple';

    // YouTube Music: music.youtube.com/playlist?list=... など
    if(host.includes('music.youtube.com')) return 'ytm';

    // YouTube playlist: youtube.com/playlist?list=...
    if(host.includes('youtube.com') && url.pathname.includes('/playlist')) return 'ytm';

    return 'unknown';
  }

  function buildLinks(u){
    const platform = detectPlatform(u);

    // ① 元URLそのまま
    btnOpen.href = u;

    // ① 各アプリ用：判定できる場合はそのボタンだけ強める
    btnApple.href = (platform === 'apple') ? u : 'https://music.apple.com/';
    btnSpotify.href = (platform === 'spotify') ? u : 'https://open.spotify.com/';
    btnYTM.href = (platform === 'ytm') ? u : 'https://music.youtube.com/';

    // ② TuneMyMusic導線（確実版）
    // ここは「TMMトップを開いて、URL貼る」でもいいが、共有FAQも読めるようにしておく
    // まずはトップへ（URL自動注入は公式仕様を確定できてないのでやらない）
    btnTMM.href = 'https://www.tunemymusic.com/';
    btnTMM.dataset.source = platform;

    let pLabel = ({
      apple:'Apple Music',
      spotify:'Spotify',
      ytm:'YouTube Music',
      unknown:'不明（でもOK）'
    })[platform];

    status.innerHTML =
      '検出：<strong>' + pLabel + '</strong><br/>' +
      '②は <strong>TuneMyMusic</strong> を開いて、ソース選択→このURLを貼って進めてね。<br/>' +
      '<span class="mono">' + escapeHtml(u) + '</span>';

    actions.style.display = 'flex';

    // ちょい親切：URLを自動でクリップボードにコピーしておく（失敗しても無視）
    navigator.clipboard?.writeText(u).then(()=>{
      status.innerHTML += '<br/><span class="ok">（URLはクリップボードにもコピーしたよ）</span>';
    }).catch(()=>{});
  }

  function escapeHtml(s){
    return s.replace(/[&<>"']/g, c => ({
      '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#039;'
    }[c]));
  }

  btnBuild.addEventListener('click', ()=>{
    const u = safeURL(elUrl.value.trim());
    if(!u){
      actions.style.display = 'none';
      status.textContent = 'URLが正しくないっぽい。https:// から始まるプレイリストURLを貼ってね。';
      return;
    }
    buildLinks(u);
  });

  btnClear.addEventListener('click', ()=>{
    elUrl.value = '';
    actions.style.display = 'none';
    status.textContent = '状態：クリアしたよ。URL貼って〜';
    elUrl.focus();
  });

  btnDemo.addEventListener('click', ()=>{
    // Spotify公式っぽい形式例（実際のIDはダミー）
    elUrl.value = 'https://open.spotify.com/playlist/37i9dQZF1DXcBWIGoYBM5M';
    btnBuild.click();
  });

  // Enterでも実行
  elUrl.addEventListener('keydown', (e)=>{
    if(e.key === 'Enter') btnBuild.click();
  });
})();
</script>
</body>
</html>
